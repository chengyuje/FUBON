eSoafApp.controller("BannerController",["$rootScope","$scope","$controller","$http","$cookies","socketService","sysInfoService","projInfoService","$confirm","ngDialog","$window","getParameter",function(e,n,o,t,s,r,i,l,c,a,u,p){o("BaseController",{$scope:n}),n.IsMobile="mobile"==l.getLoginSourceToken(),n.role=i.getPriID()[0],n.canQuick=!0,n.sendRecv("CRM911","checkQuick","com.systex.jbranch.app.server.fps.crm911.CRM911InputVO",{},function(e,o){o||angular.forEach(e[0].body.resultList,function(e){e.PARAM_CODE==n.role&&(n.canQuick=!1)}),p.XML(["SYS.AAS_SSO_ACC_PW"],function(e){if(e){var o=e.data[e.key.indexOf("SYS.AAS_SSO_ACC_PW")];n.AAS_SSO_ACC_PW_ENABLED=!1,angular.forEach(o,function(e,o){"ENABLED"==e.DATA&&(n.AAS_SSO_ACC_PW_ENABLED="Y"==e.LABEL)})}})}),n.reload=function(){n.$emit("e-unload-alert","MobilePlatform")},n.switchRole=function(){var e=n.userList;a.open({template:"assets/txn/CMFPG000/CMFPG000_AGENT.html",className:"CMFPG000",showClose:!1,controller:["$scope",function(n){n.userList=e}]}).closePromise.then(function(e){"successful"===e.value&&n.setSysInfoService(l.LoginInfo)})},n.custExist="N",n.order=function(){"ID"==n.inputVO.crm110Type&&(n.inputVO.cust_id=n.inputVO.cust.toUpperCase()),n.inputVO.orderOption=void 0,n.custExist="Y"},n.change=function(){n.custExist="N"},n.selectOption=function(){for(var o=["SOT110","SOT111","SOT130","SOT140","SOT150","SOT120","SOT121","SOT210","SOT211","SOT220","SOT221","SOT310","SOT320","SOT410","SOT420","SOT510","SOT520"],t=!1,s=0;s<o.length;s++)if(n.inputVO.orderOption==o[s]){t=!0;break}t?n.connector("set","SOTCustID",n.inputVO.cust):n.connector("set","ORG110_custID",n.inputVO.cust),e.menuItemInfo.url="assets/txn/"+n.inputVO.orderOption+"/"+n.inputVO.orderOption+".html"},n.loginOut=function(){c({text:"確定登出 個金分行業務管理系統?"},{size:"sm"}).then(function(){n.sendRecv("CMFPG000","tlroff","com.systex.jbranch.app.server.fps.cmfpg000.LoginPageVO",{},function(e,o){o?n.msgData=e.body.msgData:(l.setApServerName(null),l.setUserList(null),l.setUserID(null),l.setUserName(null),l.setApplicationID(null),l.setBranchID(null),l.setBranchName(null),l.setWsID(null),l.setRoleID(null),l.setRoleName(null),l.setAvailBranch(null),l.setAvailRegion(null),l.setAvailArea(null),l.setUser(null),l.setAoCode(null),n.$emit("e-unload-alert","Login"))})})},n.chkToken=function(e){e.preventDefault(),null!=u.navigator.userAgent.match(/iPad;\s.*\sMac\s.*/i)||"mobile"==i.getLoginSourceToken()?n.sendRecv("SSO001","takeToken","java.util.HashMap",{id:i.getUserID()},function(e,o){o||(window.webkit.messageHandlers.jumpMappMethod?window.webkit.messageHandlers.jumpMappMethod.postMessage(e[0].body.MAPP_URL):window.location=e[0].body.MAPP_URL,void 0!=e[0].body.errMsg&&n.showErrorMsg(e[0].body.errMsg))}):n.sendRecv("SSO001","doGeESoafWebUrl","java.util.HashMap",{id:i.getUserID()},function(e,o){o||(window.open(e[0].body.url),void 0!=e[0].body.errMsg&&n.showErrorMsg(e[0].body.errMsg))})}}]);