/**================================================================================================
@program: eProgress.js
@description: 
@version: 1.0.20170313
=================================================================================================*/
eSoafApp.directive("eProgress",["$q","$timeout","$interval","ngDialog",function(e,r,i,t){return{restrict:"E",transclude:!0,scope:{type:"@?",value:"=?",max:"=?",min:"=?",width:"@?",height:"@?",hide:"=?"},template:function(e,r){var i='<div style="margin:10px;"><div class="e-prog"><div class="e-prog-graph"><div class="e-prog-graph-right"><div class="e-prog-graph-right-inside"></div></div><div class="e-prog-graph-left"><div class="e-prog-graph-left-inside"></div></div></div><div class="e-prog-middle">	<div class="e-prog-middle-icon-watch"></div>	<div class="e-prog-middle-icon-arrow"></div>	<div class="e-prog-middle-text-wrap" ng-if="!hide.txt">		<span class="e-prog-middle-text-1" ng-bind="$percent.toString().substring(0,1)"></span>		<span ng-if="$percent.toString().length>1" class="e-prog-middle-text-2" ng-bind="$percent.toString().substring(1,2)"></span>		<span ng-if="$percent.toString().length>2" class="e-prog-middle-text-3" ng-bind="$percent.toString().substring(2,3)"></span>	%</div></div></div></div>';return i},link:function(r,i,t,n,a){r.value?r.value:0,r.angle?r.angle:0,r.angleArr?r.angleArr:0,r.width="200px"|r.width,r.height="200px"|r.height,r.w=null,r.h=null,r._w=i.parent().width(),r._h=i.parent().height(),r.$w=null,r.$h=null;r.$watch("value",function(){switch(r.$percent=0,type(r.value)){case"string":r.value.indexOf("%")>-1?r.$percent=parseInt(r.value.substring(0,r.value.indexOf("%").trim())):(r.max?r.max:r.max=100,isNaN(parseInt(r.max))?r.max=100:r.max,isNaN(parseInt(r.value))?r.value=0:r.value,r.$percent=parseInt(parseInt(r.value)/parseInt(r.max)*100));break;case"number":r.max?r.max:r.max=100,isNaN(parseInt(r.max))?r.max=100:r.max,r.$percent=parseInt(r.value/parseInt(r.max)*100)}r.$percent<=50?(r.angle=3.6*r.$percent-180,$(i).find(".e-prog-graph-left-inside").css("transform","rotate(180deg)").animate({"":""}),$(i).find(".e-prog-graph-right-inside").css("transform","rotate("+r.angle+"deg)"),$(i).find(".e-prog-middle-icon-arrow").css("transform","rotate("+3.6*r.$percent+"deg)"),r.$percent<10?$(i).find(".e-prog-middle-text-wrap").css("margin-left","64px"):$(i).find(".e-prog-middle-text-wrap").css("margin-left","60px")):r.$percent>50&&r.$percent<=100?($(i).find(".e-prog-graph-right-inside").css("transform","rotate(0)"),r.angle=3.6*r.$percent-360,$(i).find(".e-prog-graph-left-inside").css("transform","rotate("+r.angle+"deg)"),$(i).find(".e-prog-middle-icon-arrow").css("transform","rotate("+r.angle+"deg)"),r.$percent<100?$(i).find(".e-prog-middle-text-wrap").css("margin-left","60px"):$(i).find(".e-prog-middle-text-wrap").css("margin-left","50px")):r.$percent>100&&$(i).find(".e-prog-middle-text-wrap").css("margin-left","50px"),$(i).find(".e-prog-graph-right-inside").removeClass("background-level-1 background-level-2 background-level-3"),$(i).find(".e-prog-graph-left-inside").removeClass("background-level-1 background-level-2 background-level-3"),r.$percent>=0&&r.$percent<33?($(i).find(".e-prog-graph-right-inside").addClass("background-level-3"),$(i).find(".e-prog-graph-left-inside").addClass("background-level-3")):r.$percent>=33&&r.$percent<60?($(i).find(".e-prog-graph-right-inside").addClass("background-level-2"),$(i).find(".e-prog-graph-left-inside").addClass("background-level-2")):r.$percent>=60&&($(i).find(".e-prog-graph-right-inside").addClass("background-level-1"),$(i).find(".e-prog-graph-left-inside").addClass("background-level-1"))}),r.sizing=function(r,t){var n=e.defer();return $(i).find(".e-prog-graph, .e-prog-middle").css({"-ms-transform":"scale("+r+","+t+")","-webkit-transform":"scale("+r+","+t+")",transform:"scale("+r+","+t+")"}),n.resolve(),n.promise},r.$watch("width",function(e,r,t){e&&(t.width?(t.width.indexOf("%")>-1?(t.w=.01*parseInt(t.width.replace("%","")),t.h=.01*parseInt(t.width.replace("%",""))):t.width.toLowerCase().indexOf("px")>-1&&(t.w=t.width.replace("px","")/t._w,t.h=t.width.replace("px","")/t._w),t.sizing(t.w,t.h).then(function(){$(i).children().css({width:$(i).find(".e-prog-graph").outerWidth()*t.w,height:$(i).find(".e-prog-graph").outerHeight()*t.w})}),t.w>1&&$(i).children().css({"padding-top":20*t.w,"padding-left":20*t.w})):(t.height.indexOf("%")>-1?(t.w=.01*parseInt(t.height.replace("%","")),t.h=.01*parseInt(t.height.replace("%",""))):t.height.toLowerCase().indexOf("px")>-1&&(t.w=t.height.replace("px","")/t._w,t.h=t.height.replace("px","")/t._w),t.sizing(t.w,t.h).then(function(){$(i).children().css({width:$(i).find(".e-prog-graph").outerWidth()*t.w,height:$(i).find(".e-prog-graph").outerHeight()*t.w})}),t.w>1&&$(i).children().css({"padding-top":20*t.w,"padding-left":20*t.w})))}),r.$watch("height",function(e,r,t){e&&(t.width?(t.width.indexOf("%")>-1?(t.w=.01*parseInt(t.width.replace("%","")),t.h=.01*parseInt(t.width.replace("%",""))):t.width.toLowerCase().indexOf("px")>-1&&(t.w=t.width.replace("px","")/t._w,t.h=t.width.replace("px","")/t._w),t.sizing(t.w,t.h).then(function(){$(i).children().css({width:$(i).find(".e-prog-graph").outerWidth()*t.w,height:$(i).find(".e-prog-graph").outerHeight()*t.w})}),t.w>1&&$(i).children().css({"padding-top":20*t.w,"padding-left":20*t.w})):(t.height.indexOf("%")>-1?(t.w=.01*parseInt(t.height.replace("%","")),t.h=.01*parseInt(t.height.replace("%",""))):t.height.toLowerCase().indexOf("px")>-1&&(t.w=t.height.replace("px","")/t._w,t.h=t.height.replace("px","")/t._w),t.sizing(t.w,t.h).then(function(){$(i).children().css({width:$(i).find(".e-prog-graph").outerWidth()*t.w,height:$(i).find(".e-prog-graph").outerHeight()*t.w})}),t.w>1&&$(i).children().css({"padding-top":20*t.w,"padding-left":20*t.w})))})}}}]);