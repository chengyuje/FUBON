<style>
.bigspace{
	margin-left: 50px !important;
}
.form-control-CRM2310 {
    padding: 4px 10px;
    font-size: 16px;
    color: #666666;
    background-color: #f4f4f4;
    border: 1px solid #999999;
    -webkit-box-shadow: none;
    box-shadow: none;
    -webkit-transition: none;
    -o-transition: none;
    transition: none;
	-webkit-border-radius: 0px;
	-moz-border-radius:0px;
	border-radius:0px;
}
.formatWidth{
	width:150px !important;
	float: left !important;
}
.datewidthByClass{
	width:150px !important;
	float: left !important;
}
</style>
<script type="text/javascript" src="assets/txn/CRM2310/CRM2310.js"></script>
<script type="text/javascript" src="assets/txn/CRM230/CRM230.js"></script>
<script type="text/javascript" src="assets/txn/CUS160/CUS160_ADD.js"></script>
<script type="text/javascript" src="assets/txn/CRM230/CRM230_COMPANY.js"></script>

<div ng-controller="CRM2310Controller" ng-cloak>
	<div>
		<div class="tfb_content">
			<div class="tfb_content_icon"></div>
			<div class="tfb_content_tit"><img src="assets/images/icon/tfb_icon_a15.gif" >查詢條件</div>
		</div>
		<div class="panel_content">
			<div ng-include="'assets/txn/CRM230/CRM230_COMMON.html'"></div>
			<div class="search_table search_box3">
				<hr>
				<h4>定存</h4>
				<table>
     				<tr>
     					<th>商品幣別：</th>
     					<td>
    						<e-combobox id="crcy_type" 
										ng-paramtype="FPS.CURRENCY"
										ng-model="inputVO.crcy_type"
			   							ng-validate="false" 
			   							ng-readonly="false" 
			   							ng-editable="false"
			   							ng-format="F3"
			   							ng-required="false"
			   							width="200px" 
                            			height="30px" 
                            			style="line-height:20px;" />
     					</td>
     					<th>存單金額：</th>
     					<td>
     						<div class="form-group">
			     				<div class="formatWidth"><input type="text" class="form-control" placeholder="請輸入..." id="cd_samt" name="cd_samt" ng-model="inputVO.cd_samt" e-input-limit="ND" e-length-limit="12"></div>
			     				<div style="float: left !important;">&nbsp ~ &nbsp</div>
			     				<div class="formatWidth"><input type="text" class="form-control" placeholder="請輸入..." id="cd_eamt" name="cd_eamt" ng-model="inputVO.cd_eamt" e-input-limit="ND" e-length-limit="12"></div>
			     			</div>
     					</td>
     					<th></th>
     					<td></td>
  			  		</tr>
	
     				<tr>
     					<th>起息日：</th>
     					<td>
     						<div class="form-group">
			     				<div class="input-group datebox datewidthByClass">
	                                <input 	type="text" id="value_sDate" name="value_sDate"
											class="form-control" 
											uib-datepicker-popup="yyyy/MM/dd"
											ng-model="inputVO.value_sDate" 
											is-open="model.c"
											datepicker-options="value_sDateOptions" 
											ng-readonly="true"
											ng-change="limitDate2()" 
											size = "13"/>
                                	<span class="input-group-btn">
                                    	<button type="button" class="btn btn-default" ng-click="open($event,'c')">
                                        	<i class="glyphicon glyphicon-calendar"></i>
                                    	</button>
                                	</span>
			     				</div>
			     				<div style="float: left !important;">&nbsp ~ &nbsp</div>
			     				<div class="input-group datebox datewidthByClass">
                                    <input 	type="text" id="value_eDate" name="value_eDate"
											class="form-control" 
											uib-datepicker-popup="yyyy/MM/dd"
											ng-model="inputVO.value_eDate" 
											is-open="model.d"
											datepicker-options="value_eDateOptions" 
											ng-readonly="true"
											ng-change="limitDate2()" 
											size = "13"/>
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-default" ng-click="open($event,'d')">
                                            <i class="glyphicon glyphicon-calendar"></i></button>
                                    </span>
								</div>
			     			</div>
     					</td>
     					<th>到期日：</th>
    			 		<td>
    			 			<div class="form-group">
			     				<div class="input-group datebox datewidthByClass">
	                                <input 	type="text" id="due_sDate" name="due_sDate"
											class="form-control" 
											uib-datepicker-popup="yyyy/MM/dd"
											ng-model="inputVO.due_sDate" 
											is-open="model.e"
											datepicker-options="due_sDateOptions" 
											ng-readonly="true"
											ng-change="limitDate3()" 
											size = "13"/>
                                	<span class="input-group-btn">
                                    	<button type="button" class="btn btn-default" ng-click="open($event,'e')">
                                        	<i class="glyphicon glyphicon-calendar"></i>
                                    	</button>
                                	</span>
			     				</div>
			     				<div style="float: left !important;">&nbsp ~ &nbsp</div>
			     				<div class="input-group datebox datewidthByClass">
                                	<input 	type="text" id="due_eDate" name="due_eDate"
											class="form-control" 
											uib-datepicker-popup="yyyy/MM/dd"
											ng-model="inputVO.due_eDate" 
											is-open="model.f"
											datepicker-options="due_eDateOptions" 
											ng-readonly="true"
											ng-change="limitDate3()" 
											size = "13"/>
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-default" ng-click="open($event,'f')">
                                            <i class="glyphicon glyphicon-calendar"></i></button>
                                    </span>
								</div>
			     			</div>
     					</td>
     				</tr>	
				</table>
			</div>

			<div class="search_box_btn text-center">
				<button type="button" class="btn btn-info" ng-click="inquireInit();inquire();" function-type="query">查詢</button>
				<button type="button" class="btn btn-info" ng-click="clearAll();init();">清除</button>
			</div>
		</div>
	</div>
	<!-- 結果區 -->
	<div>
		<div class="tfb_content">
			<div class="tfb_content_icon"></div>
			<div class="tfb_content_tit"><img src="assets/images/icon/tfb_icon_a15.gif" >查詢結果</div>
		</div>
		<!--Content of the panel-->
		<div class="panel_content">
			<!-- 分頁 -->
			<uib-tabset active="0" justified="true">
			
				<uib-tab index="0" heading="客戶資訊">
					<!-- 新增待辦 -->
					<div ng-include="'assets/txn/CRM230/CRM230_INVESTTAB.html'"></div>
					<!-- 客戶資訊 -->
					<div ng-include="'assets/txn/CRM230/CRM230_CUSTTAB.html'"></div>
				</uib-tab>			
			
				<uib-tab index="1" heading="投資資訊">
					<e-jumping-once output="outputVO" list="resultListData" totallist="resultList"></e-jumping-once>
					<div class="gv_tab_sc scroll_y" style="white-space: nowrap;">
						<table class="e-table-freeze" e-height="360px" e-left="2" e-list="resultListData" e-mode="1" e-top="true">
							<thead>
								<tr>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="CUST_ID" e-query="inquire()">客戶ID</e-sorter></th>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="CUST_NAME" e-query="inquire()">客戶姓名</e-sorter></th>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="DTL_TYPE" e-query="inquire()">明細類型</e-sorter></th>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="PROD_TYPE" e-query="inquire()">商品類型</e-sorter></th>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="BRA_NBR" e-query="inquire()">分行代碼</e-sorter></th>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="AO_CODE" e-query="inquire()">AO CODE</e-sorter></th>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="CRCY_TYPE" e-query="inquire()">幣別</e-sorter></th>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="CD_AMT" e-query="inquire()">存單金額</e-sorter></th>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="REF_EXCH_RATE" e-query="inquire()">參考匯率</e-sorter></th>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="VALUE_DATE" e-query="inquire()">起息日</e-sorter></th>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="DUE_DATE" e-query="inquire()">到期日</e-sorter></th>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="AUTO_RLOR_YN" e-query="inquire()">自動續存</e-sorter></th>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="INT_TYPE" e-query="inquire()">利率別</e-sorter></th>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="INT_RATE" e-query="inquire()">利率%</e-sorter></th>
									<th><e-sorter e-input="inputVO" e-mode="auto" e-col="ACC_NBR" e-query="inquire()">定存帳號</e-sorter></th>
								</tr>
							</thead>
							<tbody>
								<tr class="repeat-row" ng-repeat="row in resultListData | limitTo:displayLimit track by $index" ng-class-odd="'rowOdd'" ng-class-even="'rowEven'">
									<td><a href="" onclick="return false" ng-click="goCRM610(row)" >{{row.CUST_ID}}</a></td>	<!-- 客戶ID -->
									<td>{{row.CUST_NAME}}</td>  																<!-- 客戶姓名 -->
									<td>{{row.DTL_TYPE}}</td>   																<!-- 明細類型 -->
									<td>{{row.PROD_TYPE}}</td>   																<!-- 商品類型 -->
									<td>{{row.BRA_NBR}}</td>   																	<!-- 分行代碼 -->
									<td>{{row.AO_CODE}}</td>   																	<!-- AO CODE -->
									<td>{{row.CRCY_TYPE | mapping:mappingSet['FPS.CURRENCY']:'F3'}}</td> 						<!-- 幣別 -->
									<td align = "right">{{row.CD_AMT | number : 0}}</td>   										<!-- 存單金額 -->
									<td align = "right">{{row.REF_EXCH_RATE | number : 4}}</td>  								<!-- 參考匯率 -->
									<td>{{toJsDate(row.VALUE_DATE) | date: "yyyy-MM-dd"}}</td>  								<!-- 起息日 -->
									<td>{{toJsDate(row.DUE_DATE) | date: "yyyy-MM-dd"}}</td>  									<!-- 到期日 -->
									<td>{{row.AUTO_RLOR_YN | mapping:mappingSet['CRM.CRM230_YN']:'F3'}}</td>  					<!-- 自動續存 -->
									<td>{{row.INT_TYPE | mapping:mappingSet['CRM.INT_TYPE']:'F3'}}</td>  						<!-- 利率別 -->
									<td align = "right">{{row.INT_RATE | number : 2}}</td>  									<!-- 利率% -->
									<td align = "right">{{row.ACC_NBR}}</td>  													<!-- 定存帳號 -->
								</tr>
							</tbody>
						</table>
					</div>
					<div class="gv_tab_sc scroll_y" style="white-space: nowrap;">
						<table align="left" style="width:30%">
							<thead>
							<h4>幣別合計</h4>
								<tr>
									<th>幣別</th>
									<th>存單金額(合計)</th>
								</tr>
							</thead>
							<tbody>
								<tr class="repeat-row" ng-repeat="(key, data) in resultList | groupBy: 'CRCY_TYPE'">
									<td>{{key | mapping:mappingSet['FPS.CURRENCY']:'F3'}}</td>
									<td align = "right">{{getSum(data, 'CD_AMT') | number : 2}}</td>     <!-- 待確認取到小數第幾位 -->
								</tr>
							</tbody>
						</table>
					</div>
				</uib-tab>
			</uib-tabset>
		</div>
	</div>
	<!-- 結果區 -->
</div>