<configuration debug="false" scan="true" scanPeriod="10 seconds">    <!--<define name="JBRANCH_ROOT" class="com.systex.jbranch.platform.common.log.JBranchRootPropertyDefiner"/> -->    <property name="JBRANCH_ROOT" value="/esoaf/logs" scope="context"/>    <property name="encoding" value="UTF-8" scope="context"/>    <property name="maxSize" value="25MB" scope="context"/>    <property name="defaultFileName" value="default" scope="context"/>    <property name="pattern"              value="[%d{yyyy/MM/dd HH:mm:ss.SSS}] [%thread] %-5level %logger{36}[%line] [%X{$TXN_CODE}] [%X{$BRANCHID}] [%X{$WSID}] [%X{$TLRID}] [%X{$REQUEST_ID}] - %msg%n"              scope="context"/>    <property name="esb_pattern" value="[%d{yyyy/MM/dd HH:mm:ss.SSS}]%msg%n" scope="context"/>    <turboFilter class="ch.qos.logback.classic.turbo.MDCFilter">        <MDCKey>$TXN_CODE</MDCKey>        <Value>SIMSG001</Value>        <OnMatch>DENY</OnMatch>    </turboFilter>    <appender name="FILE_LOG" class="ch.qos.logback.classic.sift.SiftingAppender">        <discriminator>            <Key>$IP</Key>            <DefaultValue>${defaultFileName}</DefaultValue>        </discriminator>        <sift>            <appender name="FILE_LOG"                      class="ch.qos.logback.core.rolling.RollingFileAppender">                <Append>true</Append>                <file>${JBRANCH_ROOT}/jbranch_${$IP}.log</file>                <filter class="ch.qos.logback.classic.filter.ThresholdFilter">                    <level>INFO</level>                </filter>                <rollingPolicy                        class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">                    <fileNamePattern>${JBRANCH_ROOT}/archive/jbranch_${$IP}.%d{yyyy-MM-dd}.log.zip                    </fileNamePattern>                    <maxHistory>3</maxHistory>                </rollingPolicy><!--                <triggeringPolicy--><!--                        class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">--><!--                    <maxFileSize>${maxSize}</maxFileSize>--><!--                </triggeringPolicy>-->                <!-- <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"> -->                <!-- <fileNamePattern>${JBRANCH_ROOT}/log/backup/jbranch.${WSID}.%d{yyyy-MM-dd}.%i.log.zip</fileNamePattern> -->                <!-- <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"> -->                <!-- <maxFileSize>1KB</maxFileSize> -->                <!-- </timeBasedFileNamingAndTriggeringPolicy> -->                <!-- <maxHistory>3</maxHistory> -->                <!-- <cleanHistoryOnStart>true</cleanHistoryOnStart> -->                <!-- </rollingPolicy> -->                <encoder>                    <pattern>${pattern}</pattern>                    <charset>${encoding}</charset>                </encoder>            </appender>        </sift>    </appender>    <appender name="TITA_TOTA_LOG" class="ch.qos.logback.classic.sift.SiftingAppender">        <discriminator>            <Key>$IP</Key>            <DefaultValue>${defaultFileName}</DefaultValue>        </discriminator>        <sift>            <appender name="TITA_TOTA_LOG"                      class="ch.qos.logback.core.rolling.RollingFileAppender">                <Append>true</Append>                <file>${JBRANCH_ROOT}/tita_tota_${$IP}.log</file>                <filter class="ch.qos.logback.classic.filter.ThresholdFilter">                    <level>INFO</level>                </filter>                <rollingPolicy                        class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy">                    <fileNamePattern>${JBRANCH_ROOT}/archive/tita_tota.${$IP}.%i.log.zip                    </fileNamePattern>                    <minIndex>1</minIndex>                    <maxIndex>1</maxIndex>                </rollingPolicy>                <triggeringPolicy                        class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">                    <maxFileSize>${maxSize}</maxFileSize>                </triggeringPolicy>                <!-- <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"> -->                <!-- <fileNamePattern>${JBRANCH_ROOT}/log/backup/tita_tota.${WSID}.%d{yyyy-MM-dd}.%i.log.zip</fileNamePattern> -->                <!-- <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"> -->                <!-- <maxFileSize>2MB</maxFileSize> -->                <!-- </timeBasedFileNamingAndTriggeringPolicy> -->                <!-- <maxHistory>3</maxHistory> -->                <!-- <cleanHistoryOnStart>true</cleanHistoryOnStart> -->                <!-- </rollingPolicy> -->                <encoder>                    <pattern>${pattern}</pattern>                    <charset>${encoding}</charset>                </encoder>            </appender>        </sift>    </appender>    <appender name="TITA_TOTA_XMLVO_LOG" class="ch.qos.logback.classic.sift.SiftingAppender">        <discriminator>            <Key>$IP</Key>            <DefaultValue>${defaultFileName}</DefaultValue>        </discriminator>        <sift>            <appender name="TITA_TOTA_LOG"                      class="ch.qos.logback.core.rolling.RollingFileAppender">                <Append>true</Append>                <file>${JBRANCH_ROOT}/tita_tota_xmlvo_${$IP}.log</file>                <filter class="ch.qos.logback.classic.filter.ThresholdFilter">                    <level>INFO</level>                </filter>                <rollingPolicy                        class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy">                    <fileNamePattern>${JBRANCH_ROOT}/archive/tita_tota_xmlvo_${$IP}.%i.log.zip                    </fileNamePattern>                    <minIndex>1</minIndex>                    <maxIndex>1</maxIndex>                </rollingPolicy>                <triggeringPolicy                        class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">                    <maxFileSize>${maxSize}</maxFileSize>                </triggeringPolicy>                <!-- <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"> -->                <!-- <fileNamePattern>${JBRANCH_ROOT}/log/backup/tita_tota_xmlvo.${WSID}.%d{yyyy-MM-dd}.%i.log.zip</fileNamePattern> -->                <!-- <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"> -->                <!-- <maxFileSize>2MB</maxFileSize> -->                <!-- </timeBasedFileNamingAndTriggeringPolicy> -->                <!-- <maxHistory>3</maxHistory> -->                <!-- <cleanHistoryOnStart>true</cleanHistoryOnStart> -->                <!-- </rollingPolicy> -->                <encoder>                    <pattern>${pattern}</pattern>                    <charset>${encoding}</charset>                </encoder>            </appender>        </sift>    </appender>    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">        <encoder>            <pattern>${pattern}</pattern>            <charset>${encoding}</charset>        </encoder>    </appender>    <appender name="COMMSG"              class="ch.qos.logback.core.rolling.RollingFileAppender">        <Append>true</Append>        <file>${JBRANCH_ROOT}/jbranch_ComMsg.log</file>        <filter class="ch.qos.logback.classic.filter.ThresholdFilter">            <level>INFO</level>        </filter>        <rollingPolicy class="ch.qos.logback.core.rolling.FixedWindowRollingPolicy">            <fileNamePattern>${JBRANCH_ROOT}/archive/jbranch_ComMsg.%i.log.zip            </fileNamePattern>            <minIndex>1</minIndex>            <maxIndex>1</maxIndex>        </rollingPolicy>        <triggeringPolicy                class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">            <maxFileSize>${maxSize}</maxFileSize>        </triggeringPolicy>        <encoder>            <pattern>${pattern}</pattern>            <charset>${encoding}</charset>        </encoder>    </appender>    <appender name="EJ_APPENDER"              class="com.systex.jbranch.platform.common.log.appender.JBranchDBAppender">        <tableName>TBFBEJ</tableName>        <oracleIdentify>ID</oracleIdentify>        <oracleSequence>SEQ_TBFBEJ</oracleSequence>        <columnNameArray>TXCODE, EJ_TYPE, TX_TYPE, TX_MODE, TRM_SRL_NO,            LOCAL_SPV_A, LOCAL_SPV_B, HOST_SPV_A, HOST_SPV_B, TLR_NO, MODE_SUB,            CANCEL_SRL, PAGE_KEY, PAGE_UP_DOWN_FLG, TX_ATM_MODE, DB_APP_NO,            CONF_FLG, FUNC_COD, TEST_ACT_DATE, TEST_TX_SRL, RESP_CODE_47,            TX_STATUS, HOST_PROC_TIME, HOST_OVERRIDE_LVL, TX_SRL, END_KEY,            TXN_CODE, TXN_SEQ, TITA, TOTA, ACTION_ID, BCRDB, BTXTYPE, CASH,            BRANCH_ID        </columnNameArray>        <mdcKeyArray>TXCODE, EJ_TYPE, TX_TYPE, TX_MODE, TRM_SRL_NO,            LOCAL_SPV_A, LOCAL_SPV_B, HOST_SPV_A, HOST_SPV_B, TLR_NO, MODE_SUB,            CANCEL_SRL, PAGE_KEY, PAGE_UP_DOWN_FLG, TX_ATM_MODE, DB_APP_NO,            CONF_FLG, FUNC_COD, TEST_ACT_DATE, TEST_TX_SRL, RESP_CODE_47,            TX_STATUS, HOST_PROC_TIME, HOST_OVERRIDE_LVL, TX_SRL, END_KEY,            $TXN_CODE, $REQUEST_ID, FIRST_TITA, LAST_TOTA, $ACTION_ID, $BCRDB,            $BTXTYPE, $CASH, $BRANCHID        </mdcKeyArray>    </appender>    <appender name="COMM_EJ_APPENDER"              class="com.systex.jbranch.platform.common.log.appender.JBranchDBAppender">        <!--tableName：資料庫紀錄EJ資料表名稱 -->        <tableName>TBSYSFPSEJ</tableName>        <!--columnNameArray：設定DNB欄位名稱(CREATIME、CREATOR、LASTUPDATE、MODIFIER、VERSON等平台欄位元件會自行設定，此處無須設定) -->        <columnNameArray>TXNDATETIME, BRCHID, WSID, TXNCODE, TELLERID, DEPID,            ROLEID, CUSTOMERID, CUSTOMERNAME, BIZCODENAME, MEMO, RESULTDATA        </columnNameArray>        <!--mdcKeyArray：交易塞值時使用的KEY -->        <mdcKeyArray>TXNDATETIME, BRCHID, WSID, TXNCODE, TELLERID, DEPID,            ROLEID, CUSTOMERID, CUSTOMERNAME, BIZCODENAME, MEMO, RESULTDATA        </mdcKeyArray>    </appender>    <!-- <appender name="ACCO_EJ_APPENDER" class="com.systex.jbranch.app.commons.log.appender.JBranchJRDAYAppender"/> -->    <appender name="ESB_LOG_APPENDER" class="ch.qos.logback.classic.sift.SiftingAppender">        <discriminator>            <Key>$IP</Key>            <DefaultValue>${defaultFileName}</DefaultValue>        </discriminator>        <sift>            <appender name="ESB_LOG_APPENDER" class="ch.qos.logback.core.rolling.RollingFileAppender">                <Append>true</Append>                <file>${JBRANCH_ROOT}/esblog_${$IP}.log</file>                <filter class="ch.qos.logback.classic.filter.ThresholdFilter">                    <level>INFO</level>                </filter>                <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">                    <fileNamePattern>${JBRANCH_ROOT}/archive/esblog_${$IP}.%d{yyyy-MM-dd}.log.zip                    </fileNamePattern>                    <maxHistory>3</maxHistory>                </rollingPolicy><!--                <triggeringPolicy--><!--                        class="ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy">--><!--                    <maxFileSize>${maxSize}</maxFileSize>--><!--                </triggeringPolicy>-->                <encoder>                    <pattern>${esb_pattern}</pattern>                    <charset>${encoding}</charset>                </encoder>            </appender>        </sift>    </appender>    <!--============================== 異步輸出，可避免 IO 堵塞造成的效能耗損 Start ==============================-->    <appender name="ASYNC" class="ch.qos.logback.classic.AsyncAppender">        <discardingThreshold>0</discardingThreshold>        <queueSize>10</queueSize>        <appender-ref ref="FILE_LOG"/>    </appender>	<appender name="ASYNC_ESB" class="ch.qos.logback.classic.AsyncAppender">		<discardingThreshold>0</discardingThreshold>		<queueSize>10</queueSize>		<appender-ref ref="ESB_LOG_APPENDER"/>	</appender>    <!--============================== 異步輸出，可避免 IO 堵塞造成的效能耗損 End ==============================-->    <root>        <level value="INFO"/>        <appender-ref ref="ASYNC"/>        <!--<appender-ref ref="FILE_ERR"/> -->        <appender-ref ref="STDOUT" /> <!-- 正式區關閉，測試區可開啟以方便測試-->    </root>    <!-- 這段由 root logger 完成即可，不需要特定設定，所以註解    	<logger name="com.systex.jbranch" additivity="false" level="INFO">    		<appender-ref ref="FILE_LOG" />    		<appender-ref ref="STDOUT" />    	</logger>    -->    <logger name="TITA_TOTA_LOG" additivity="false" level="INFO">        <appender-ref ref="TITA_TOTA_LOG"/>        <appender-ref ref="STDOUT" /> <!-- 正式區關閉，測試區可開啟以方便測試-->    </logger>    <logger name="COMM_EJ" additivity="false" level="INFO">        <appender-ref ref="EJ_APPENDER"/>        <appender-ref ref="FILE_LOG"/>        <appender-ref ref="STDOUT" /> <!-- 正式區關閉，測試區可開啟以方便測試-->    </logger>    <logger name="ACCT_EJ" additivity="false" level="INFO">        <appender-ref ref="ACCO_EJ_APPENDER"/>        <appender-ref ref="FILE_LOG"/>        <appender-ref ref="STDOUT" /> <!-- 正式區關閉，測試區可開啟以方便測試-->    </logger>    <logger name="SECU_LOG" additivity="false" level="INFO">        <appender-ref ref="SECU_APPENDER"/>        <appender-ref ref="FILE_LOG"/>        <appender-ref ref="STDOUT" /> <!-- 正式區關閉，測試區可開啟以方便測試-->    </logger>    <logger name="WMS_EJ_LOG" additivity="false" level="INFO">        <appender-ref ref="COMM_EJ_APPENDER"/>    </logger>    <logger name="com.systex.jbranch.host.landbank.MessageTransmit"            additivity="false" level="INFO">        <appender-ref ref="TITA_TOTA_XMLVO_LOG"/>        <appender-ref ref="STDOUT" /> <!-- 正式區關閉，測試區可開啟以方便測試-->    </logger>    <logger name="com.systex.jbranch.host.landbank.CommonMessageProcessor"            additivity="false" level="INFO">        <appender-ref ref="COMMSG"/>        <appender-ref ref="STDOUT" /> <!-- 正式區關閉，測試區可開啟以方便測試-->    </logger>    <logger name="org.hibernate.event.def.DefaultLoadEventListener"            level="WARN"/><!-- ignore hibernate load not found info -->    <logger name="org.hibernate.util.DTDEntityResolver" level="ERROR"/>    <!-- <logger name="com.systex.jbranch.platform.server.pipeline.flex.RemotingService"        level="DEBUG"/> -->    <logger name="org.hibernate.SQL" level="INFO"/>    <!--============================== 電文全集中在專屬 LOG，以達分流效果 Start ==============================-->    <logger name="ESB_LOG" additivity="false" level="INFO">        <appender-ref ref="ASYNC_ESB"/>        <appender-ref ref="STDOUT" /> <!-- 正式區關閉，測試區可開啟以方便測試-->    </logger>    <logger name="com.systex.jbranch.fubon.jlb.FmpJRunTx" additivity="false" level="INFO">        <appender-ref ref="ASYNC_ESB"/>        <appender-ref ref="STDOUT" /> <!-- 正式區關閉，測試區可開啟以方便測試-->    </logger>    <logger name="TX_LOG" additivity="false" level="INFO">        <appender-ref ref="ASYNC_ESB"/>        <appender-ref ref="STDOUT" /> <!-- 正式區關閉，測試區可開啟以方便測試-->    </logger>    <logger name="com.systex.jbranch.fubon.commons.esb.xml.parse.EsbXmlParseUtil" additivity="false" level="INFO">        <appender-ref ref="ASYNC_ESB"/>        <appender-ref ref="STDOUT" /> <!-- 正式區關閉，測試區可開啟以方便測試-->    </logger>    <!--============================== 電文全集中在專屬 LOG，以達分流效果 End ==============================-->    <!-- <logger name="org.hibernate.type.descriptor.sql.BasicBinder" level="TRACE"/> -->    <!-- <logger name="org.hibernate.type.descriptor.sql.BasicExtractor" level="TRACE"/> -->    <!-- <logger name="org.hibernate.engine.QueryParameters" level="TRACE"/> -->    <!-- <logger name="org.hibernate.engine.query.HQLQueryPlan" level="TRACE"/> --></configuration>