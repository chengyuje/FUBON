/**================================================================================================
@program: eInputLimit.js
@description: 
@version: 1.0.20170313
=================================================================================================*/
eSoafApp.directive("eInputLimit",function(){return addCommasToInteger=function(e){for(var t;-1!=e.indexOf(",");)e=e.replace(",","");return t=-1==e.indexOf(".")?"":e.replace(/^\d+(?=\.)/,""),""+e.replace(/(\.\d*)$/,"").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+t},addPerCenToInteger=function(e){return e+"%"},{restrict:"A",require:"ngModel",scope:{pattern:"@pattern",nuu1:"@nuu1",nuu2:"@nuu2",type:"@eInputLimit"},link:function(e,t,n,r){r&&(e.nuu1=e.nuu1||"4",e.nuu2=e.nuu2||"2",r.$formatters.push(function(t){return!t||"NN"!==e.type&&"NABS"!==e.type&&"NC"!==e.type&&"NUU"!==e.type||(t=addCommasToInteger(t.toString())),t&&"NP"===e.type&&(t=addPerCenToInteger(t.toString())),t}),t.on("blur",function(){var e,t,n,u;if(null!=(e=r.$modelValue)){for(t=0,n=(u=r.$formatters).length;t<n;t++)e=(0,u[t])(e);return r.$viewValue=e,r.$render()}}),t.on("focus",function(){var n;return!(n=t.val())||"NN"!==e.type&&"NC"!==e.type&&"NUU"!==e.type||t.val(n.replace(/,/g,"")),n&&"NP"===e.type&&t.val(n.replace(/%/g,"")),t[0].select()}),r.$parsers.push(function(t){var n;e.pattern=e.pattern||"","EA"===e.type?n=new RegExp("[^a-zA-Z0-9"+e.pattern+"]","g"):"EAD"===e.type?n=new RegExp("[^a-zA-Z0-9-_"+e.pattern+"]","g"):"N"!==e.type&&"NN"!==e.type||(n=new RegExp("[^0-9"+e.pattern+"]","g"));var u=void 0==t?void 0:t.replace(n,"");if("ND"===e.type||"NC"===e.type)u=/^-?\d*[.]?\d*/.exec(u).toString();else if("NABS"===e.type)u=/^\d*[.]?\d*/.exec(u).toString();else if("NUU"===e.type||"NP"===e.type){var p=new RegExp("^\\d{1,"+e.nuu1+"}(\\.\\d{0,"+e.nuu2+"})?$","g");u&&!p.test(u)&&(u=r.$modelValue)}return t!=u&&(r.$setViewValue(u),r.$render()),u}))}}});