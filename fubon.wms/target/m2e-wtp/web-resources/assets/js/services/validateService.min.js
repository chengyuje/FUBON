eSoafApp.factory("validateService",["$rootScope",function($rootScope){var regExp_twbid=/^[0-9]{8}$/;return{isValidTWPID:function(id){var city=new Array(1,10,19,28,37,46,55,64,39,73,82,2,11,20,48,29,38,47,56,65,74,83,21,3,12,30);id=id.toUpperCase();var custId=id.toUpperCase();if(console.log("id = "+id),-1==id.search(/^[A-Z](1|2|8|9)\d{8}$/i))return $rootScope.showErrorMsg("客戶編號檢核:基本格式錯誤("+custId+")"),!1;id=id.split("");for(var total=city[id[0].charCodeAt(0)-65],i=1;i<=8;i++)total+=eval(id[i])*(9-i);total+=eval(id[9]),console.log("total = "+total);var checkTotal_Mod10=total%10==0;return 0==checkTotal_Mod10&&$rootScope.showErrorMsg("客戶編號檢核:身分證號檢核錯誤("+custId+")"),checkTotal_Mod10},isValidTWBID:function(r){var t=!1;if(regExp_twbid.test(r)){for(var o=0,i=0,e=0;e<8;e++)o=Number(r.charAt(e))*Number("12121241".charAt(e)),i+=parseInt(o/10+o%10,10),6==e&&"7"==r.charAt(e)&&(t=!0);if(t){if(i%10==0||(i+1)%10==0)return!0}else if(i%10==0)return!0}return!1},checkID:function(r){if(!(r.length>=11))if(8==r.length){if(!isNaN(Number(r))&&!this.isValidTWBID(r))throw $rootScope.showErrorMsg("客戶編號檢核:營利事業編號檢核錯誤"),new Error("營利事業編號檢核錯誤")}else if(isNaN(Number(r.charAt(0)))&&!isNaN(Number(r.charAt(1)))){var t=r.substring(0,10);if(!this.isValidTWPID(t))throw $rootScope.showErrorMsg("客戶編號檢核:身分證號檢核錯誤"),new Error("身分證號檢核錯誤")}},checkCustID:function(r){if(!r)return!1;if(r&&r.length<8)return $rootScope.showErrorMsg("客戶編號檢核:不足8碼("+r+")"),!1;if(r.length>=10){if(isNaN(Number(r.charAt(0)))&&!isNaN(Number(r.charAt(1)))){var t=r;return!!this.isValidTWPID(t)}return!0}return r.length>=8&&r.length<10||($rootScope.showErrorMsg("客戶編號檢核:失敗("+r+")"),!1)}}}]);